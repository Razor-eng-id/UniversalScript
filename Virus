-- [[ IDIOT CONTROL CENTER v8.0 ]] --
local imageID = "rbxassetid://102171623937004"
local soundID = "rbxassetid://97827245258178"

local CoreGui = game:GetService("CoreGui")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")

-- [[ GUI ROOT ]] --
local sg = Instance.new("ScreenGui", CoreGui)
sg.Name = "IdiotMenu"
sg.ResetOnSpawn = false

-- [[ DRAG LOGIC FUNCTION ]] --
local function makeDraggable(gui)
    local dragging, dragInput, dragStart, startPos
    gui.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPos = gui.Position
        end
    end)
    gui.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then dragInput = input end
    end)
    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            local delta = input.Position - dragStart
            gui.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        end
    end)
    gui.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then dragging = false end
    end)
end

-- [[ MAIN MENU BOX ]] --
local mainFrame = Instance.new("Frame", sg)
mainFrame.Size = UDim2.new(0, 150, 0, 180)
mainFrame.Position = UDim2.new(0.5, -75, 0.5, -90)
mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
mainFrame.BorderSizePixel = 0
mainFrame.Visible = true
local corner = Instance.new("UICorner", mainFrame)
corner.CornerRadius = Tool.new(0, 12)
makeDraggable(mainFrame)

-- [[ MINIMIZED BOX (ICON) ]] --
local minBox = Instance.new("ImageButton", sg)
minBox.Size = UDim2.new(0, 50, 0, 50)
minBox.Position = UDim2.new(0.1, 0, 0.5, 0)
minBox.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
minBox.Image = imageID
minBox.Visible = false
Instance.new("UICorner", minBox).CornerRadius = UDim.new(0, 10)
makeDraggable(minBox)

-- [[ UI TOGGLE LOGIC ]] --
local function toggleUI()
    if mainFrame.Visible then
        mainFrame.Visible = false
        minBox.Visible = true
        minBox.Position = mainFrame.Position
    else
        mainFrame.Visible = true
        minBox.Visible = false
        mainFrame.Position = minBox.Position
    end
end

-- Close Button inside Main Menu
local closeBtn = Instance.new("TextButton", mainFrame)
closeBtn.Size = UDim2.new(0, 20, 0, 20)
closeBtn.Position = UDim2.new(1, -25, 0, 5)
closeBtn.Text = "X"
closeBtn.TextColor3 = Color3.new(1,1,1)
closeBtn.BackgroundTransparency = 1
closeBtn.MouseButton1Click:Connect(toggleUI)
minBox.MouseButton1Click:Connect(toggleUI)

-- [[ THE VIRUS SWITCH ]] --
local virusActive = false
local toggleBtn = Instance.new("TextButton", mainFrame)
toggleBtn.Size = UDim2.new(0, 120, 0, 40)
toggleBtn.Position = UDim2.new(0, 15, 0, 70)
toggleBtn.BackgroundColor3 = Color3.fromRGB(200, 0, 0)
toggleBtn.Text = "VIRUS: OFF"
toggleBtn.Font = Enum.Font.SourceSansBold
toggleBtn.TextColor3 = Color3.new(1,1,1)
Instance.new("UICorner", toggleBtn)

toggleBtn.MouseButton1Click:Connect(function()
    virusActive = not virusActive
    if virusActive then
        toggleBtn.Text = "VIRUS: ON"
        toggleBtn.BackgroundColor3 = Color3.fromRGB(0, 200, 0)
        -- Trigger the Virus script logic here
        _G.ExecuteIdiotVirus(true)
    else
        toggleBtn.Text = "VIRUS: OFF"
        toggleBtn.BackgroundColor3 = Color3.fromRGB(200, 0, 0)
        _G.ExecuteIdiotVirus(false)
    end
end)
